<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@biulight/craco-config-extensions - v1.2.1</title><meta name="description" content="Documentation for @biulight/craco-config-extensions"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/search.js" id="tsd-search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base=".">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@biulight/craco-config-extensions - v1.2.1</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-content">
<div class="tsd-page-title">
<h2>@biulight/craco-config-extensions - v1.2.1</h2></div>
<div class="tsd-panel tsd-typography"><a id="md:biulightcraco-config-extensions" class="tsd-anchor"></a><h1><a href="#md:biulightcraco-config-extensions">@biulight/craco-config-extensions</a></h1><blockquote>
<p>用于快速配置 craco.config.js 文件，支持基于文档地址动态指定文档中URL资源地址</p>
</blockquote>
<p><a href="https://biulight.github.io/craco-config-extensions/index.html">Handbook</a></p>
<a id="md:requirements" class="tsd-anchor"></a><h2><a href="#md:requirements">Requirements</a></h2><p>基于<code>webpack5</code>和<code>@craco/craco@7.0.0</code></p>
<a id="md:install" class="tsd-anchor"></a><h2><a href="#md:install">Install</a></h2><pre><code class="language-bash"><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@biulight/craco-config-extensions</span><span class="hl-1"> </span><span class="hl-3">--save-dev</span><br/>
</code><button>Copy</button></pre>
<pre><code class="language-bash"><span class="hl-0">yarn</span><span class="hl-1"> </span><span class="hl-2">add</span><span class="hl-1"> </span><span class="hl-3">--dev</span><span class="hl-1"> </span><span class="hl-2">@biulight/craco-config-extensions</span>
</code><button>Copy</button></pre>
<a id="md:usage" class="tsd-anchor"></a><h2><a href="#md:usage">Usage</a></h2><a id="md:功能" class="tsd-anchor"></a><h3><a href="#md:功能">功能</a></h3><a id="md:钩子函数" class="tsd-anchor"></a><h4><a href="#md:钩子函数">钩子函数</a></h4><blockquote>
<p>修改<code>webpack</code>配置的钩子函数</p>
</blockquote>
<a id="md:modifyoutputconfig" class="tsd-anchor"></a><h5><a href="#md:modifyoutputconfig"><code>modifyOutputConfig</code></a></h5><p>修改<code>webpack</code>的<code>output</code>配置</p>
<a id="md:adddefinitionsenvvalue" class="tsd-anchor"></a><h5><a href="#md:adddefinitionsenvvalue"><code>addDefinitionsEnvValue</code></a></h5><p>修改<code>DefinePlugin</code>插件</p>
<a id="md:addhtmlwebpackplugin" class="tsd-anchor"></a><h5><a href="#md:addhtmlwebpackplugin"><code>addHtmlWebpackPlugin</code></a></h5><p>修改 <code>html-webpack-plugin</code> 插件</p>
<a id="md:addinterpolatehtmlplugin" class="tsd-anchor"></a><h5><a href="#md:addinterpolatehtmlplugin"><code>addInterpolateHtmlPlugin</code></a></h5><p>修改<code>create-react-app</code>内置的<code>InterpolateHtmlPlugin</code>插件</p>
<a id="md:addsplitchunksplugin" class="tsd-anchor"></a><h5><a href="#md:addsplitchunksplugin"><code>addSplitChunksPlugin</code></a></h5><p>修改<code>webpack</code>的<code>Optimization.splitChunks</code></p>
<a id="md:plugin" class="tsd-anchor"></a><h4><a href="#md:plugin">Plugin</a></h4><a id="md:htmlwebpackinjecthead" class="tsd-anchor"></a><h5><a href="#md:htmlwebpackinjecthead"><code>HtmlWebpackInjectHead</code></a></h5><p>详见<a href="#%E6%96%B9%E6%A1%88%E4%B8%80%E6%97%A7%E6%96%B9%E6%A1%88">动态加载指定域名静态资源</a>方案一</p>
<a id="md:htmlwebpackmixinrobot" class="tsd-anchor"></a><h5><a href="#md:htmlwebpackmixinrobot"><code>HtmlWebpackMixinRobot</code></a></h5><p>详见<a href="#%E6%96%B9%E6%A1%88%E4%BA%8C%E6%8E%A8%E8%8D%90">动态加载指定域名静态资源</a>方案二</p>
<a id="md:cracoplugin" class="tsd-anchor"></a><h4><a href="#md:cracoplugin">cracoPlugin</a></h4><a id="md:sassresourcesloader" class="tsd-anchor"></a><h5><a href="#md:sassresourcesloader"><code>sassResourcesLoader</code></a></h5><blockquote>
<p><code>sass-resources-loader</code> 的 <code>craco</code> 版本</p>
</blockquote>
<pre><code class="language-js"><span class="hl-3">const</span><span class="hl-1"> { </span><span class="hl-4">sassResourcesLoader</span><span class="hl-1"> } = </span><span class="hl-0">require</span><span class="hl-1">(</span><span class="hl-2">`@biulight/craco-config-extensions`</span><span class="hl-1">)</span><br/><br/><span class="hl-5">module</span><span class="hl-1">.</span><span class="hl-5">exports</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-6">plugins:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-6">plugin:</span><span class="hl-1"> </span><span class="hl-6">sassResourcesLoader</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">options:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">resources:</span><span class="hl-1"> </span><span class="hl-2">&#39;src/common/index.scss&#39;</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:工具函数" class="tsd-anchor"></a><h4><a href="#md:工具函数">工具函数</a></h4><a id="md:override" class="tsd-anchor"></a><h5><a href="#md:override"><code>override</code></a></h5><p>高阶函数，支持配置函数链式调用，详见示例</p>
<a id="md:stringifyval" class="tsd-anchor"></a><h5><a href="#md:stringifyval"><code>stringifyVal</code></a></h5><p>将对象中value转换成JSON字符串</p>
<a id="md:readalldotenvfiles" class="tsd-anchor"></a><h5><a href="#md:readalldotenvfiles"><code>readAllDotenvFiles</code></a></h5><p>读取指定<code>.env</code>文件中指定前缀的变量</p>
<a id="md:loadrobot" class="tsd-anchor"></a><h4><a href="#md:loadrobot"><code>LoadRobot</code></a></h4><p>使用方式详见<a href="https://biulight.github.io/craco-config-extensions/LoadRobot.html">LoadRobot</a></p>
<a id="md:示例" class="tsd-anchor"></a><h3><a href="#md:示例">示例</a></h3><a id="md:override函数" class="tsd-anchor"></a><h4><a href="#md:override函数"><code>override</code>函数</a></h4><pre><code class="language-js"><span class="hl-3">const</span><span class="hl-1"> { </span><span class="hl-4">override</span><span class="hl-1"> } = </span><span class="hl-0">require</span><span class="hl-1">(</span><span class="hl-2">&quot;@biulight/craco-config-extensions&quot;</span><span class="hl-1">)</span><br/><br/><span class="hl-5">module</span><span class="hl-1">.</span><span class="hl-5">exports</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-6">webpack:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">configure:</span><span class="hl-1"> </span><span class="hl-0">override</span><span class="hl-1">(</span><span class="hl-6">func1</span><span class="hl-1">, </span><span class="hl-6">func2</span><span class="hl-1">),</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:在-html-模板-head-标签里注入资源" class="tsd-anchor"></a><h4><a href="#md:在-html-模板-head-标签里注入资源">在 html 模板 head 标签里注入资源</a></h4><pre><code class="language-js"><span class="hl-3">const</span><span class="hl-1"> { </span><span class="hl-4">HtmlWebpackInjectHead</span><span class="hl-1"> } = </span><span class="hl-0">require</span><span class="hl-1">(</span><span class="hl-2">&quot;@biulight/craco-config-extensions&quot;</span><span class="hl-1">)</span><br/><br/><span class="hl-5">module</span><span class="hl-1">.</span><span class="hl-5">exports</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-6">webpack:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">plugins:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">add:</span><span class="hl-1"> [</span><br/><span class="hl-1">        </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">HtmlWebpackInjectHead</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-6">content:</span><span class="hl-1"> </span><span class="hl-2">&quot;&lt;script src=&#39;preload.worker.js&#39;&gt;&lt;/script&gt;&quot;</span><span class="hl-1"> </span><span class="hl-7">/* 插入的内容 */</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-6">position:</span><br/><span class="hl-1">            </span><span class="hl-2">&quot;start&quot;</span><span class="hl-1"> </span><span class="hl-7">/* start（默认值）: 在head顶部插入; end: 在head底部插入*/</span><span class="hl-1">,</span><br/><span class="hl-1">        }),</span><br/><span class="hl-1">      ],</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:读取指定env文件中指定前缀配置" class="tsd-anchor"></a><h4><a href="#md:读取指定env文件中指定前缀配置">读取指定<code>.env</code>文件中指定前缀配置</a></h4><blockquote>
<p>文件读取规则等同于<code>create-react-app</code>脚手架中读取<code>.env</code></p>
</blockquote>
<p>.env.production</p>
<pre><code><span class="hl-6">__DYNAMIC_KEY</span><span class="hl-1">=</span><span class="hl-6">production</span><span class="hl-1">.</span><span class="hl-6">html</span><span class="hl-1">.</span><span class="hl-6">example</span><span class="hl-1">.</span><span class="hl-6">com</span><br/><span class="hl-6">__DYNAMIC_ENV</span><span class="hl-1">=</span><span class="hl-4">PRD</span><br/><span class="hl-6">__DYNAMIC_DOMAIN_SERVER</span><span class="hl-1">=</span><span class="hl-6">production</span><span class="hl-1">.</span><span class="hl-6">server</span><span class="hl-1">.</span><span class="hl-6">example</span><span class="hl-1">.</span><span class="hl-6">com</span><br/><span class="hl-6">__DYNAMIC_STATIC_DOMAIN</span><span class="hl-1">=</span><span class="hl-6">production</span><span class="hl-1">.</span><span class="hl-6">cdn</span><span class="hl-1">.</span><span class="hl-6">example</span><span class="hl-1">.</span><span class="hl-6">com</span><br/>
</code><button>Copy</button></pre>
<pre><code class="language-js"><span class="hl-3">const</span><span class="hl-1"> { </span><span class="hl-4">readAllDotenvFiles</span><span class="hl-1"> } = </span><span class="hl-0">require</span><span class="hl-1">(</span><span class="hl-2">&quot;@biulight/craco-config-extensions&quot;</span><span class="hl-1">)</span><br/><br/><span class="hl-7">// 读取.env.production, .env.develpment, .env.stg 等文件</span><br/><span class="hl-3">const</span><span class="hl-1"> { </span><span class="hl-6">__DYNAMIC</span><span class="hl-1">: </span><span class="hl-4">DYNAMIC_ENV</span><span class="hl-1"> } = </span><span class="hl-0">readAllDotenvFiles</span><span class="hl-1">(</span><br/><span class="hl-1">  [</span><span class="hl-2">&quot;production&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;development&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;stg&quot;</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;__DYNSMIC&quot;</span><br/><span class="hl-1">)</span><br/><span class="hl-7">/*</span><br/><span class="hl-7">DYNAMIC_ENV:</span><br/><br/><span class="hl-7"> */</span>
</code><button>Copy</button></pre>
<a id="md:注意事项" class="tsd-anchor"></a><h5><a href="#md:注意事项">注意事项</a></h5><ul>
<li><code>__DYNAMIC_KEY</code>会被忽略，只用来指定 html 文件资源域名</li>
<li><code>__DYNAMIC_STATIC_DOMAIN</code>: 当与<code>loadRobot</code>结合使用时，会自动创建<code>base</code>标签，并把 href 指向它的值</li>
</ul>
<a id="md:动态映射域名" class="tsd-anchor"></a><h4><a href="#md:动态映射域名">动态映射域名</a></h4><pre><code class="language-js"><span class="hl-8">import</span><span class="hl-1"> </span><span class="hl-6">CracoEnv</span><span class="hl-1"> </span><span class="hl-8">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@biulight/craco-config-extensions/dist/loadRobot&quot;</span><br/><br/><span class="hl-7">// 创建</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-4">envInstance</span><span class="hl-1"> = </span><span class="hl-6">CracoEnv</span><span class="hl-1">.</span><span class="hl-0">createInstance</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;production.html.example.com&quot;</span><span class="hl-6">:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">ENV:</span><span class="hl-1"> </span><span class="hl-2">&quot;PRD&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">DOMAIN_SERVER:</span><span class="hl-1"> </span><span class="hl-2">&quot;production.server.example.com&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-7">// STATIC_DOMAIN: &quot;production.cdn.example.com&quot;,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-6">localhost:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">ENV:</span><span class="hl-1"> </span><span class="hl-2">&quot;DEV&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">DOMAIN_SERVER:</span><span class="hl-1"> </span><span class="hl-2">&quot;/api&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-7">// STATIC_DOMAIN: &quot;/&quot;,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-7">// 使用</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-4">server</span><span class="hl-1"> = </span><span class="hl-6">envInstance</span><span class="hl-1">.</span><span class="hl-4">DOMAIN_SERVER</span>
</code><button>Copy</button></pre>
<blockquote>
<p>结合 <code>HtmlWebpackInjectHead</code> 或 <code>HtmlWebpackMixinRobot</code> 使用时</p>
</blockquote>
<pre><code class="language-js"><span class="hl-8">import</span><span class="hl-1"> </span><span class="hl-6">CracoEnv</span><span class="hl-1"> </span><span class="hl-8">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@biulight/craco-config-extensions/dist/loadRobot&quot;</span><br/><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-4">envInstance</span><span class="hl-1"> = </span><span class="hl-6">CracoEnv</span><span class="hl-1">.</span><span class="hl-0">getInstance</span><span class="hl-1">();</span><br/><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-4">server</span><span class="hl-1"> = </span><span class="hl-6">envInstance</span><span class="hl-1">.</span><span class="hl-4">DOMAIN_SERVER</span><span class="hl-1">;</span>
</code><button>Copy</button></pre>
<a id="md:动态加载指定域名静态资源" class="tsd-anchor"></a><h4><a href="#md:动态加载指定域名静态资源">动态加载指定域名静态资源</a></h4><blockquote>
<p>依托<code>html</code>文件域名，动态加载指定 cdn 静态资源</p>
</blockquote>
<a id="md:方案一旧方案" class="tsd-anchor"></a><h5><a href="#md:方案一旧方案">方案一(旧方案)</a></h5><ol>
<li>使用 loadRobot 类的 umd 文件,提供全局变量<code>_BIU_LOAD_ROBOT</code></li>
</ol>
<pre><code class="language-js"><span class="hl-7">// 编辑craco.config.js文件</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-4">CopyWebpackPlugin</span><span class="hl-1"> = </span><span class="hl-0">require</span><span class="hl-1">(</span><span class="hl-2">&quot;copy-webpack-plugin&quot;</span><span class="hl-1">)</span><br/><span class="hl-3">const</span><span class="hl-1"> { </span><span class="hl-4">HtmlWebpackInjectHead</span><span class="hl-1"> } = </span><span class="hl-0">require</span><span class="hl-1">(</span><span class="hl-2">&quot;@biulight/craco-config-extensions&quot;</span><span class="hl-1">)</span><br/><br/><span class="hl-5">module</span><span class="hl-1">.</span><span class="hl-5">exports</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-6">webpack:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">plugins:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">add:</span><span class="hl-1"> [</span><br/><span class="hl-1">        </span><span class="hl-7">// 复制文件到打包产物目录</span><br/><span class="hl-1">        </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">CopyWebpackPlugin</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-6">patterns:</span><span class="hl-1"> [</span><br/><span class="hl-1">            {</span><br/><span class="hl-1">              </span><span class="hl-6">from:</span><span class="hl-1"> </span><span class="hl-2">&quot;node_modules/@biulight/craco-config-extensions/dist/loadRobot/index.umd.js&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">              </span><span class="hl-6">to:</span><span class="hl-1"> </span><span class="hl-2">&quot;preload.worker.js&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            },</span><br/><span class="hl-1">          ],</span><br/><span class="hl-1">        }),</span><br/><span class="hl-1">        </span><span class="hl-7">// 注入模板</span><br/><span class="hl-1">        </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">HtmlWebpackInjectHead</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-6">content:</span><span class="hl-1"> </span><span class="hl-2">&quot;&lt;script src=&#39;preload.worker.js&#39;&gt;&lt;/script&gt;&quot;</span><span class="hl-1"> </span><span class="hl-7">/* 插入的内容 */</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-6">position:</span><br/><span class="hl-1">            </span><span class="hl-2">&quot;start&quot;</span><span class="hl-1"> </span><span class="hl-7">/* start（默认值）: 在head顶部插入; end: 在head底部插入*/</span><span class="hl-1">,</span><br/><span class="hl-1">        }),</span><br/><span class="hl-1">      ],</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<ol start="2">
<li>往<code>html</code>模版中注入变量</li>
</ol>
<pre><code class="language-js"><span class="hl-5">module</span><span class="hl-1">.</span><span class="hl-5">exports</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-6">webpack:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">configure:</span><span class="hl-1"> </span><span class="hl-0">override</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-0">addInterpolateHtmlPlugin</span><span class="hl-1">({</span><br/><span class="hl-1">        ...</span><span class="hl-0">stringifyVal</span><span class="hl-1">({ </span><span class="hl-6">DYNAMIC_ENV</span><span class="hl-1"> }),</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">    ),</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<ol start="3">
<li>修改<code>html</code>模板</li>
</ol>
<pre><code class="language-html"><span class="hl-7">&lt;!-- head头部加入实例化loadRobot逻辑 --&gt;</span><br/><span class="hl-9">&lt;</span><span class="hl-10">script</span><span class="hl-9">&gt;</span><br/><span class="hl-11">  </span><span class="hl-6">_BIU_LOAD_ROBOT</span><span class="hl-11">.</span><span class="hl-0">createInstance</span><span class="hl-11">(</span><span class="hl-4">JSON</span><span class="hl-11">.</span><span class="hl-0">parse</span><span class="hl-11">(</span><span class="hl-2">&quot;%DYNAMIC_ENV%&quot;</span><span class="hl-11">))</span><br/><span class="hl-9">&lt;/</span><span class="hl-10">script</span><span class="hl-9">&gt;</span>
</code><button>Copy</button></pre>
<ol start="4">
<li>禁用<code>HtmlWebpackPlugin</code>插件将生成的 <code>webpack</code> 文件添加到资产</li>
</ol>
<ul>
<li>修改<code>html-webpack-plugin</code></li>
</ul>
<pre><code class="language-js"><span class="hl-7">// 编辑craco.config.js</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-4">HtmlWebpackPlugin</span><span class="hl-1"> = </span><span class="hl-0">require</span><span class="hl-1">(</span><span class="hl-2">&quot;html-webpack-plugin&quot;</span><span class="hl-1">)</span><br/><span class="hl-5">module</span><span class="hl-1">.</span><span class="hl-5">exports</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-6">webpack:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">plugins:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">add:</span><span class="hl-1"> [</span><br/><span class="hl-1">        </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">HtmlWebpackPlugin</span><span class="hl-1">({</span><br/><span class="hl-1">          ...</span><br/><span class="hl-1">          </span><span class="hl-6">inject</span><span class="hl-1">: </span><span class="hl-3">false</span><span class="hl-1">, </span><span class="hl-7">// disable automatic injections</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">      ]</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<ul>
<li>修改<code>html</code>模板，动态加载资源</li>
</ul>
<pre><code class="language-html"><span class="hl-9">&lt;</span><span class="hl-10">head</span><span class="hl-9">&gt;</span><br/><span class="hl-1">  </span><span class="hl-7">&lt;!-- 插入如下代码 --&gt;</span><br/><span class="hl-1">  </span><span class="hl-12">&lt;</span><span class="hl-1">%= &quot;</span><span class="hl-9">&lt;</span><span class="hl-10">script</span><span class="hl-9">&gt;</span><span class="hl-2">&quot; %</span><span class="hl-12">&gt;</span><br/><span class="hl-11">    </span><span class="hl-6">_BIU_LOAD_ROBOT</span><span class="hl-11">.</span><span class="hl-0">load</span><span class="hl-11">([</span><span class="hl-1">...</span><span class="hl-2">&quot;&lt;%= htmlWebpackPlugin.files.css %&gt;,&lt;%= htmlWebpackPlugin.files.js %&gt;&quot;</span><span class="hl-11">.</span><span class="hl-0">split</span><span class="hl-11">(</span><span class="hl-2">&quot;,&quot;</span><span class="hl-11">)])</span><br/><span class="hl-11">  </span><span class="hl-1">&lt;%=</span><span class="hl-11"> </span><span class="hl-2">&quot;&lt;/script&gt;&quot;</span><span class="hl-11"> </span><span class="hl-1">%&gt;</span><br/><span class="hl-1">&lt;/</span><span class="hl-6">head</span><span class="hl-1">&gt;</span>
</code><button>Copy</button></pre>
<p>  <code>inject: false</code> 示例，参考<a href="https://github.com/jantimon/html-webpack-plugin/tree/main/examples/custom-insertion-position">html-webpack-plugin</a>
  模板语法参考<a href="https://ejs.co/#docs">EJS</a> </p>
<a id="md:方案二（推荐）" class="tsd-anchor"></a><h5><a href="#md:方案二（推荐）">方案二（推荐）</a></h5><blockquote>
<p>使用<code>HtmlWebpackMixinRobot</code>插件</p>
</blockquote>
<p>修改<code>craco.config.js</code> 插件</p>
<ol>
<li>禁用<code>HtmlWebpackPlugin</code>插件将生成的 <code>webpack</code> 文件添加到资产</li>
</ol>
<ul>
<li>修改<code>html-webpack-plugin</code></li>
</ul>
<pre><code class="language-js"><span class="hl-7">// 编辑craco.config.js</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-4">HtmlWebpackPlugin</span><span class="hl-1"> = </span><span class="hl-0">require</span><span class="hl-1">(</span><span class="hl-2">&quot;html-webpack-plugin&quot;</span><span class="hl-1">)</span><br/><span class="hl-5">module</span><span class="hl-1">.</span><span class="hl-5">exports</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-6">webpack:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">plugins:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">add:</span><span class="hl-1"> [</span><br/><span class="hl-1">        </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">HtmlWebpackPlugin</span><span class="hl-1">({</span><br/><span class="hl-1">          ...</span><br/><span class="hl-1">          </span><span class="hl-6">scriptLoading</span><span class="hl-1">: </span><span class="hl-2">&quot;blocking&quot;</span><span class="hl-1">, </span><span class="hl-7">// 动态创建`script`标签时，`defer` 属性不生效</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">      ]</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<ol start="2">
<li>使用<code>HtmlWebpackMixinRobot</code>插件动态创建<code>base</code>标签并添加资产</li>
</ol>
<pre><code class="language-js"><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-4">CopyWebpackPlugin</span><span class="hl-1"> = </span><span class="hl-0">require</span><span class="hl-1">(</span><span class="hl-2">&quot;copy-webpack-plugin&quot;</span><span class="hl-1">)</span><br/><span class="hl-3">const</span><span class="hl-1"> { </span><span class="hl-4">HtmlWebpackMixinRobot</span><span class="hl-1"> } = </span><span class="hl-0">require</span><span class="hl-1">(</span><span class="hl-2">&quot;@biulight/craco-config-extensions&quot;</span><span class="hl-1">)</span><br/><br/><span class="hl-5">module</span><span class="hl-1">.</span><span class="hl-5">exports</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-6">webpack:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">plugins:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">add:</span><span class="hl-1"> [</span><br/><span class="hl-1">        </span><span class="hl-7">// 复制文件到打包产物目录</span><br/><span class="hl-1">        </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">CopyWebpackPlugin</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-6">patterns:</span><span class="hl-1"> [</span><br/><span class="hl-1">            {</span><br/><span class="hl-1">              </span><span class="hl-6">from:</span><span class="hl-1"> </span><span class="hl-2">&quot;node_modules/@biulight/craco-config-extensions/dist/loadRobot/index.umd.js&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">              </span><span class="hl-6">to:</span><span class="hl-1"> </span><span class="hl-2">&quot;preload.worker.js&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            },</span><br/><span class="hl-1">          ],</span><br/><span class="hl-1">        }),</span><br/><span class="hl-1">        </span><span class="hl-7">// js创建标签，添加 `webpack` bundle </span><br/><span class="hl-1">        </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">HtmlWebpackMixinRobot</span><span class="hl-1">(</span><span class="hl-6">HtmlWebpackPlugin</span><span class="hl-1">, { </span><br/><span class="hl-1">          </span><span class="hl-6">env:</span><span class="hl-1"> </span><span class="hl-4">JSON</span><span class="hl-1">.</span><span class="hl-0">stringify</span><span class="hl-1">(</span><span class="hl-4">DYNAMIC_ENV</span><span class="hl-1">), </span><span class="hl-7">// 可选，默认值：默认读取 .env 文件动态变量</span><br/><span class="hl-1">          </span><span class="hl-6">robotUrl:</span><span class="hl-1"> </span><span class="hl-2">&quot;preload.worker.js&quot;</span><span class="hl-1">, </span><span class="hl-7">// 可选, 当`robotUrl`和`env`同时存在，会实例化`loadRobot`类</span><br/><span class="hl-1">          </span><span class="hl-6">robotInstance:</span><span class="hl-1"> </span><span class="hl-2">&quot;BIU_BIU&quot;</span><span class="hl-1">, </span><span class="hl-7">// 可选，挂载在`global`对象上key，默认值`BIU_LIGHT_ROBOT_INSTANCE`</span><br/><span class="hl-1">          </span><span class="hl-6">force:</span><span class="hl-1"> </span><span class="hl-3">true</span><span class="hl-1">, </span><span class="hl-7">// 可选,是否强制匹配pathname，默认值false(不匹配)</span><br/><span class="hl-1">          </span><span class="hl-6">prefix:</span><span class="hl-1"> </span><span class="hl-2">&quot;__DYNAMIC&quot;</span><span class="hl-1"> </span><span class="hl-7">// 可选，当env配置为空时，指定 .env 文件动态变量的前缀，默认值 `__DYNAMIC`</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">      ]</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/>
</code><button>Copy</button></pre>
<p><code>DYNAMIC_ENV</code>: 详见<a href="#%E8%AF%BB%E5%8F%96%E6%8C%87%E5%AE%9Aenv%E6%96%87%E4%BB%B6%E4%B8%AD%E6%8C%87%E5%AE%9A%E5%89%8D%E7%BC%80%E9%85%8D%E7%BD%AE">读取指定<code>.env</code>文件中指定前缀配置</a></p>
</div></div>
<div class="col-sidebar">
<div class="page-menu">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)" id="icon-chevronDown"></path></svg>Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="#icon-chevronDown"></use></svg>On This Page</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li>
<ul>
<li><a href="#md:biulightcraco-config-extensions"><span>@biulight/craco-<wbr/>config-<wbr/>extensions</span></a></li>
<li>
<ul>
<li><a href="#md:requirements"><span>Requirements</span></a></li>
<li><a href="#md:install"><span>Install</span></a></li>
<li><a href="#md:usage"><span>Usage</span></a></li>
<li>
<ul>
<li><a href="#md:功能"><span>功能</span></a></li>
<li>
<ul>
<li><a href="#md:钩子函数"><span>钩子函数</span></a></li>
<li>
<ul>
<li><a href="#md:modifyoutputconfig"><span>modify<wbr/>Output<wbr/>Config</span></a></li>
<li><a href="#md:adddefinitionsenvvalue"><span>add<wbr/>Definitions<wbr/>Env<wbr/>Value</span></a></li>
<li><a href="#md:addhtmlwebpackplugin"><span>add<wbr/>Html<wbr/>Webpack<wbr/>Plugin</span></a></li>
<li><a href="#md:addinterpolatehtmlplugin"><span>add<wbr/>Interpolate<wbr/>Html<wbr/>Plugin</span></a></li>
<li><a href="#md:addsplitchunksplugin"><span>add<wbr/>Split<wbr/>Chunks<wbr/>Plugin</span></a></li></ul></li>
<li><a href="#md:plugin"><span>Plugin</span></a></li>
<li>
<ul>
<li><a href="#md:htmlwebpackinjecthead"><span>Html<wbr/>Webpack<wbr/>Inject<wbr/>Head</span></a></li>
<li><a href="#md:htmlwebpackmixinrobot"><span>Html<wbr/>Webpack<wbr/>Mixin<wbr/>Robot</span></a></li></ul></li>
<li><a href="#md:cracoplugin"><span>craco<wbr/>Plugin</span></a></li>
<li>
<ul>
<li><a href="#md:sassresourcesloader"><span>sass<wbr/>Resources<wbr/>Loader</span></a></li></ul></li>
<li><a href="#md:工具函数"><span>工具函数</span></a></li>
<li>
<ul>
<li><a href="#md:override"><span>override</span></a></li>
<li><a href="#md:stringifyval"><span>stringify<wbr/>Val</span></a></li>
<li><a href="#md:readalldotenvfiles"><span>read<wbr/>All<wbr/>Dotenv<wbr/>Files</span></a></li></ul></li>
<li><a href="#md:loadrobot"><span>Load<wbr/>Robot</span></a></li></ul></li>
<li><a href="#md:示例"><span>示例</span></a></li>
<li>
<ul>
<li><a href="#md:override函数"><span>override函数</span></a></li>
<li><a href="#md:在-html-模板-head-标签里注入资源"><span>在 html 模板 head 标签里注入资源</span></a></li>
<li><a href="#md:读取指定env文件中指定前缀配置"><span>读取指定.env文件中指定前缀配置</span></a></li>
<li>
<ul>
<li><a href="#md:注意事项"><span>注意事项</span></a></li></ul></li>
<li><a href="#md:动态映射域名"><span>动态映射域名</span></a></li>
<li><a href="#md:动态加载指定域名静态资源"><span>动态加载指定域名静态资源</span></a></li>
<li>
<ul>
<li><a href="#md:方案一旧方案"><span>方案一(旧方案)</span></a></li>
<li><a href="#md:方案二（推荐）"><span>方案二（推荐）</span></a></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></div></details></div>
<div class="site-menu">
<nav class="tsd-navigation"><a href="index.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><g id="icon-4"><rect fill="var(--color-icon-background)" stroke="var(--color-ts-namespace)" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="6"></rect><path d="M9.33 16V7.24H10.77L13.446 14.74C13.43 14.54 13.41 14.296 13.386 14.008C13.37 13.712 13.354 13.404 13.338 13.084C13.33 12.756 13.326 12.448 13.326 12.16V7.24H14.37V16H12.93L10.266 8.5C10.282 8.692 10.298 8.936 10.314 9.232C10.33 9.52 10.342 9.828 10.35 10.156C10.366 10.476 10.374 10.784 10.374 11.08V16H9.33Z" fill="var(--color-text)"></path></g></svg><span>@biulight/craco-<wbr/>config-<wbr/>extensions -<wbr/> v1.2.1</span></a>
<ul class="tsd-small-nested-navigation">
<li><a href="modules/loadRobot.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>load<wbr/>Robot</span></a></li>
<li><a href="modules/main.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>main</span></a></li></ul></nav></div></div></div>
<div class="tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div></body></html>